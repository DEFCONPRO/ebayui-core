var Ie=Object.defineProperty;var He=(t,i,e)=>i in t?Ie(t,i,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[i]=e;var d=(t,i,e)=>(He(t,typeof i!="symbol"?i+"":i,e),e);import{r as Re,b as Me,p as V,g as v,f as Ke,d as Ue,t as Ve}from"./registry-EgEQwbXk.js";/* empty css                    */import{_ as f}from"./dynamic-tag-7vXwaVzE.js";import{_ as qe}from"./index-MJalx9GY.js";import{_ as q}from"./render-tag-_0PNNh6Y.js";import{_ as j}from"./index-VGoHc-V3.js";import"./preserve-attrs-lolIpBRv.js";import{s as ze}from"./index-ERL0bCNR.js";import{r as se,h as Xe}from"./index-XjwwBzg5.js";let c,p,S,N,P,F,L,le,re;function Ye(){const t=document.createElement("div");return t.setAttribute("aria-hidden","true"),t.setAttribute("tabindex","0"),t.className="keyboard-trap-boundary",t}function z(){le.focus()}function X(){re.focus()}function Ze(){p=Ye(),S=p.cloneNode(),N=p.cloneNode(),P=p.cloneNode(),F=p.cloneNode(),L=p.cloneNode(),p.addEventListener("focus",z),S.addEventListener("focus",z),N.addEventListener("focus",X),P.addEventListener("focus",z),F.addEventListener("focus",X),L.addEventListener("focus",X)}function oe(){return c&&(p=_(p),S=_(S),N=_(N),P=_(P),F=_(F),L=_(L),c.classList.remove("keyboard-trap--active"),c.dispatchEvent(new CustomEvent("keyboardUntrap",{bubbles:!0})),c=null),c}function _(t){const i=t.parentNode;return i?i.removeChild(t):t}function Ge(t){p?oe():Ze(),c=t;const i=typeof document>"u"?null:document.body,e=ze(c,!0);return le=e[0],re=e[e.length-1],i.insertBefore(p,i.childNodes[0]),c.parentNode.insertBefore(S,c),c.insertBefore(N,c.childNodes[0]),c.appendChild(P),c.parentNode.insertBefore(F,c.nextElementSibling),i.appendChild(L),c.dispatchEvent(new CustomEvent("keyboardTrap",{bubbles:!0})),c.classList.add("keyboard-trap--active"),c}const Je=t=>t.nodeType===1&&t.tagName.toLowerCase()!=="body"&&t.tagName.toLowerCase()!=="html",Qe=t=>t.nodeType===1&&t.tagName.toLowerCase()!=="script",We=(t,i)=>t.concat(i);function ae(t,i=[]){const e=t.previousSibling;return e?(i.push(e),ae(e,i)):i}function ce(t,i=[]){const e=t.nextSibling;return e?(i.push(e),ce(e,i)):i}function ue(t){return ae(t).concat(ce(t)).filter(Qe)}function de(t,i=[]){const e=t.parentNode;return e?(i.push(e),de(e,i)):i}function fe(t){return de(t).filter(Je)}function Oe(t){return fe(t).map(i=>ue(i)).reduce(We,[])}let B,E,x;const D=t=>t.tagName.toLowerCase()!=="svg";function ee(t,i){let e;return i===!1?e=I(t,"aria-hidden","false"):e=I(t,"hidden",!1),e}function te(t,i){let e;return i===!1?e=I(t,"aria-hidden","true"):e=I(t,"hidden",!0),e}function I(t,i,e){const n=typeof e=="boolean";return{el:t,attributeName:i,cleanValue:n?t[i]:t.getAttribute(i),dirtyValue:e,isProperty:n}}function je(t){t.isProperty===!0?t.el[t.attributeName]=t.dirtyValue:t.el.setAttribute(t.attributeName,t.dirtyValue)}function De(t){t.cleanValue?t.isProperty===!0?t.el[t.attributeName]=t.cleanValue:t.el.setAttribute(t.attributeName,t.cleanValue):t.el.removeAttribute(t.attributeName)}function he(){E&&(x.forEach(t=>De(t)),x=[],B&&B.setAttribute("role","main"),E.dispatchEvent(new CustomEvent("screenreaderUntrap",{bubbles:!0})),E=null)}const et={useHiddenProperty:!1};function tt(t,i){he();const e=Object.assign({},et,i);E=t,B=document.querySelector('main, [role="main"]'),B&&B.setAttribute("role","presentation");const n=fe(E);let o=ue(E),r=Oe(E);e.useHiddenProperty===!0&&(o=o.filter(D),r=r.filter(D)),x=[ee(E,e.useHiddenProperty)].concat(n.map(a=>ee(a,e.useHiddenProperty))).concat(o.map(a=>te(a,e.useHiddenProperty))).concat(r.map(a=>te(a,e.useHiddenProperty))),x.forEach(a=>je(a)),E.dispatchEvent(new CustomEvent("screenreaderTrap",{bubbles:!0}))}let pe,C,H=!1;function me(){if(!H){const{body:t}=document,{pageXOffset:i,pageYOffset:e}=window,{width:n,height:o,marginTop:r,marginLeft:a}=getComputedStyle(t);let l="position:fixed;overflow:hidden;";pe=[i,e],C=t.getAttribute("style"),l+=`height:${o};`,l+=`width:${n};`,e&&(l+=`margin-top:${-1*(e-parseInt(r,10))}px;`),i&&(l+=`margin-left:${-1*(i-parseInt(a,10))}px`),C&&(l=`${C};${l}`),t.setAttribute("style",l),se.addEventListener("",ge),H=!0}}function Ee(){if(H){const{body:t}=document;C?t.setAttribute("style",C):t.removeAttribute("style"),window.scrollTo(...pe),se.removeEventListener("",ge),H=!1}}function ge(){Ee(),me()}const Y="transitionend",ie=({el:t,className:i,waitFor:e},n)=>{let o,r=0;const a=e?e.length:0,l=t.classList,h=`${i}-init`;if(!("ontransitionend"in t)){const u=setTimeout(n,0);return()=>clearTimeout(u)}let m=it(()=>{m=void 0,l.add(i),l.remove(h),a?e.forEach(u=>u.addEventListener(Y,g)):(w(),n&&n())});return l.add(h),w;function w(){if(!o){o=!0;for(let u=r;u<a;u++)e[u].removeEventListener(Y,g);m?(m(),l.remove(h)):l.remove(i)}}function g({target:u}){u==null||u.removeEventListener(Y,g),++r===a&&(o=!0,l.remove(i),n&&n())}};function it(t){let i;return i=requestAnimationFrame(()=>{i=requestAnimationFrame(t)}),()=>{i&&(cancelAnimationFrame(i),i=0)}}class nt extends Marko.Component{constructor(){super(...arguments);d(this,"clickTarget");d(this,"startEl");d(this,"closeEl");d(this,"windowEl");d(this,"rootEl");d(this,"bodyEl");d(this,"transitionEls");d(this,"isTrapped");d(this,"restoreTrap");d(this,"_prevFocusEl");d(this,"cancelTransition");d(this,"cancelScrollReset");d(this,"isAnimating")}get useHiddenProperty(){return this.input.useHiddenProperty||!1}trackLastClick(e){if(e.defaultPrevented||e.metaKey||e.ctrlKey||e.shiftKey||e.button!==0)return;let n=e.target;for(;n!==null&&n.nodeName!=="BUTTON";)n=n.parentNode;this.clickTarget=n}getActiveElement(e){let n=null;e&&e.closeFocus&&(n=document.getElementById(e.closeFocus));const o=document.activeElement===document.body?this.clickTarget:document.activeElement;return n||o}handleStartClick({target:e}){this.startEl=e}handleScroll(){this.emit("scroll")}handleKeydown(e){Xe(e,()=>{this.state.open=!1})}handleDialogClick({target:e,clientY:n}){const{closeEl:o,windowEl:r,startEl:a}=this;if(this.startEl=null,this.input.buttonPosition!=="hidden"&&!(r!=null&&r.contains(a??null))){if(!(o!=null&&o.contains(e))&&(r!=null&&r.contains(e))){const{bottom:l}=r.getBoundingClientRect(),{paddingBottom:h}=getComputedStyle(r),m=l-parseInt(h,10);if(n<m)return}this.state.open=!1}}handleCloseButtonClick(){this.state.open=!1}onInput(e){e.isModal=e.isModal!==!1,this.isAnimating||(this.state={open:e.open||!1})}onRender(){typeof window<"u"&&this._release()}onMount(){this.rootEl=this.getEl()??null,this.windowEl=this.getEl("window")??null,this.closeEl=this.getEl("close")??null,this.bodyEl=this.getEl("body")??null,this.input.transitionEl==="root"?this.transitionEls=[this.rootEl]:this.input.transitionEl==="window"?this.transitionEls=[this.windowEl]:this.transitionEls=[this.windowEl,this.rootEl],this.subscribeTo(this.rootEl).on("click",()=>{}),this._trap({firstRender:!0})}onUpdate(){this._trap({firstRender:!1})}_triggerFocus(e){this.input.isModal&&e&&e.focus()}_triggerBodyScroll(e){this.input.isModal&&(e?me():Ee())}onDestroy(){this._cancelAsync(),this._release(),this.isTrapped&&this._triggerBodyScroll(!1)}_getTrapCallback(e,n,o){const r=this.input.isModal&&(e||n&&!o),a=this.useHiddenProperty;return()=>{r&&(tt(this.el,{useHiddenProperty:a}),a||Ge(this.windowEl))}}_trap(e){var w,g;const{isTrapped:n,restoreTrap:o}=this,r=this.isTrapped=this.state.open,a=e&&e.firstRender,l=r!==n,h=this.input.focus&&document.getElementById(this.input.focus)||this.closeEl,m=this._getTrapCallback(o??!1,r,n??!1);if(a&&this.input.isModal&&r&&(this._prevFocusEl=this.getActiveElement(this.input),h&&this._triggerFocus(h),this._triggerBodyScroll(!0)),l){this._cancelAsync();const u=()=>{var A,y,T;if(this.cancelTransition=void 0,m(),r)(A=this.rootEl)==null||A.removeAttribute("hidden"),this._triggerFocus(h),this.emit("open"),this.isAnimating=!1;else{this._triggerBodyScroll(!1);const G=this.getActiveElement(this.input);(y=this.rootEl)==null||y.setAttribute("hidden",""),this.emit("close"),this.isAnimating=!1,G===this.getActiveElement(this.input)&&document.documentElement.contains(this._prevFocusEl??null)&&((T=this._prevFocusEl)==null||T.focus()),this.cancelScrollReset=setTimeout(()=>{var $,k;(k=($=this.rootEl)==null?void 0:$.parentNode)==null||k.replaceChild(this.rootEl,this.rootEl),this.cancelScrollReset=void 0},20)}};r?a?(this.isAnimating=!1,(w=this.rootEl)==null||w.removeAttribute("hidden"),m()):(this._prevFocusEl=this.getActiveElement(this.input),this._triggerBodyScroll(!0),this.isAnimating=!0,this.cancelTransition=ie({el:this.rootEl,className:`${this.input.classPrefix}--show`,waitFor:this.transitionEls??[]},u)):a?(this.isAnimating=!1,(g=this.rootEl)==null||g.setAttribute("hidden","")):(this.isAnimating=!0,this.cancelTransition=ie({el:this.rootEl,className:`${this.input.classPrefix}--hide`,waitFor:this.transitionEls??[]},u))}else o&&m()}_release(){this.isTrapped&&this.input.isModal?(this.restoreTrap=this.state.open,he(this.el),this.useHiddenProperty||oe(this.windowEl)):this.restoreTrap=!1}_cancelAsync(){this.cancelScrollReset&&(clearTimeout(this.cancelScrollReset),this.cancelScrollReset=void 0),this.cancelTransition&&(this.cancelTransition(),this.cancelTransition=void 0)}}const Z="ZSiMe4+1",R=Ve(Z),ne=typeof window<"u";Re.r(Z,()=>R);const ye=nt;R._=Me(function(t,i,e,n,o,r){const{open:a,classPrefix:l,class:h,focus:m,closeFocus:w,a11yCloseText:g,windowClass:u,baseEl:A="div",header:y,footer:T,transitionEl:G,isModal:$,closeButton:k,closeButtonClass:be,closeButtonText:M,ignoreEscape:ve,windowType:J,mainId:we,ariaLabelledby:Te,buttonPosition:b="right",useHiddenProperty:st,top:Q,action:K,prevButton:U,role:_e,renderBody:Ae,...ke}=t,{id:Be,as:Ce,class:Se,renderBody:Ne,...Pe}=y||{},{id:lt,class:Fe,a11yText:Le,renderBody:rt,...$e}=U||{};function W(s){f(s,Ce||"h2",()=>({class:[Se,`${l}__title`],...V(Pe),id:Be||n.getElId("dialog-title")}),xe=>{f(xe,Ne,null,null,null,null,e,"2")},null,null,e,"1")}function O(s){b!=="hidden"&&(s.be("button",{class:v([M?"fake-link":"icon-btn",be,`${l}__close`]),type:"button","aria-label":g},"@close",n,null,0,{onclick:e.d("click","handleCloseButtonClick",!1)}),M?s.t(M,n):k?f(s,k,null,null,null,null,e,"4"):q(qe,{},s,e,"5"),s.ee())}f(i,A,()=>({...V(ke),"aria-labelledby":Te||y&&n.getElId("dialog-title"),"aria-modal":"true",role:_e||"dialog",class:[l,h],hidden:!o.open,"aria-live":!$&&"polite"}),s=>{o.open&&ne&&!ve&&q(j,{to:typeof window=="object"&&document,__events:["on","keydown"]},s,e,"7",[["keydown","handleKeydown",!1]]),!o.open&&ne&&q(j,{to:typeof window=="object"&&window,__events:["on","click"]},s,e,"8",[["click","trackLastClick",!1]]),s.be("div",{class:v([J?`${l}__${J}-window`:`${l}__window`,u])},"@window",n,null,1,{onmouseenter:e.d("mouseenter","emit",!1,["mouseEnter"]),onmouseleave:e.d("mouseleave","emit",!1,["mouseLeave"])}),Q&&f(s,Q.renderBody,null,null,null,null,e,"9"),s.be("div",{class:v(`${l}__header`)},"10",n,null,1),U&&(s.be("button",Ke(V($e),{class:v(["icon-btn","lightbox-dialog__prev",Fe]),type:"button","aria-label":Le}),"11",n,null,4,{onclick:e.d("click","emit",!1,["prevButtonClick"])}),f(s,U,null,null,null,null,e,"12"),s.ee()),y&&b==="right"&&f(s,W,null,null,null,null,e,"13"),b!=="bottom"&&f(s,O,null,null,null,null,e,"14"),y&&(b==="left"||b==="hidden")&&f(s,W,null,null,null,null,e,"15"),s.ee(),s.be("div",{id:we,class:v(`${l}__main`)},"@body",n,null,1,{onscroll:e.d("scroll","handleScroll",!1)}),f(s,Ae,null,null,null,null,e,"16"),s.ee(),K&&(s.be("span",{class:v(`${l}__actions`)},"17",n,null,1),f(s,K&&K.renderBody,null,null,null,null,e,"18"),s.ee()),(T||b==="bottom")&&(s.be("div",{class:v(`${l}__footer`)},"19",n,null,1),f(s,T&&T.renderBody,null,null,null,null,e,"20"),b==="bottom"&&f(s,O,null,null,null,null,e,"21"),s.ee()),s.ee()},null,{pa:["hidden"]},e,"6",[["click","handleDialogClick",!1],["mousedown","handleStartClick",!1]])},{t:Z},ye);R.Component=Ue(ye,R._);export{R as _};
